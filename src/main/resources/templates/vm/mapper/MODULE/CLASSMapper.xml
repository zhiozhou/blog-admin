<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="${app.packet}.module.$!{app.moduleRef}${table.objectName}.domain.dao.${table.className}DAO">

    <insert id="save" parameterType="${table.className}PO">
        INSERT INTO ${table.name}(
#foreach($column in $table.columnList)
#if($column.name != $table.primaryKey.name)
             ${column.name} #if($velocityCount != $table.columnList.size()), #end

#end
#end
        )
        VALUES(
#foreach($column in $table.columnList)
#if($column.name != $table.primaryKey.name)
            #{$column.attrName} #if($velocityCount != $table.columnList.size()), #end

#end
#end
        )
    </insert>

    <update id="update" parameterType="${table.className}PO">
        UPDATE ${table.name}
        <set>
#foreach($column in $table.columnList)
#if($column.name != $table.primaryKey.name)
            <if test="${column.attrName} != null and ${column.attrName} != ''">${column.name} = #{${column.attrName}},</if>
#end
#end
        </set>
        WHERE ${table.primaryKey.name} = #{${table.primaryKey.attrName}}
    </update>

    <sql id="selectSQL">
        SELECT
#foreach($column in $table.columnList)
            ${column.name} #if($velocityCount != $table.columnList.size()),
#end
#end

        FROM ${table.name}
    </sql>


    <select id="get" parameterType="${table.className}DTO" resultType="${table.className}PO">
        <include refid="selectSQL"/>
        WHERE ${table.primaryKey.name} = #{${table.primaryKey.attrName}}
    </select>


    <select id="list" parameterType="${table.className}DTO" resultType="${table.className}PO">
        <include refid="selectSQL"/>
        <where>
#foreach($column in $table.columnList)
            <if test="${column.attrName} != null #if($column.javaType =="String") and ${column.attrName} != ''#end "> and ${column.name} = #{${column.attrName}}</if>
#end
        </where>
        ORDER BY ${table.primaryKey.name} DESC
    </select>


    <select id="count" parameterType="${table.className}DTO" resultType="Integer">
        SELECT
            count(0)
        FROM
        ${table.name}
        <where>
#foreach($column in $table.columnList)
            <if test="${column.attrName} != null #if($column.javaType =="String") and ${column.attrName} != ''#end "> and ${column.name} = #{${column.attrName}}</if>
#end
        </where>
    </select>
</mapper>
